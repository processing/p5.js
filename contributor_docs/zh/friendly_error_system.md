# ğŸŒ¸ p5.jså‹å¥½é”™è¯¯ç³»ç»Ÿï¼ˆFESï¼‰

## æ¦‚è¿°

å‹å¥½é”™è¯¯ç³»ç»Ÿï¼ˆFESï¼ŒğŸŒ¸ï¼‰æ—¨åœ¨é€šè¿‡æä¾›ç®€å•å‹å¥½çš„é”™è¯¯ä¿¡æ¯ï¼Œå¸®åŠ©æ–°æ‰‹ç¨‹åºå‘˜ã€‚å®ƒé€šè¿‡åœ¨é”™è¯¯æ¶ˆæ¯ä¸­æ·»åŠ æ›¿ä»£æè¿°å’Œæœ‰ç”¨çš„å‚è€ƒé“¾æ¥ï¼Œè¡¥å……äº†æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯æ¶ˆæ¯ã€‚

FESå°†æ¶ˆæ¯æ‰“å°åœ¨æ§åˆ¶å°çª—å£ä¸­ï¼Œå¯ä»¥åœ¨[p5.js Web Editor]å’Œæµè§ˆå™¨çš„JavaScriptæ§åˆ¶å°ä¸­çœ‹åˆ°ã€‚å•ä¸ªå‹ç¼©æ–‡ä»¶çš„p5ï¼ˆp5.min.jsï¼‰ä¸åŒ…å«FESã€‚

[p5.js Web Editor]: https://editor.p5js.org/

## é™ä½è°ƒè¯•éšœç¢
å·¥å…·çš„è®¾è®¡åº”è¯¥ç¬¦åˆå°†ä½¿ç”¨å®ƒçš„äººçš„éœ€æ±‚ã€‚ä½œä¸ºæ—¨åœ¨é™ä½è°ƒè¯•éšœç¢çš„å·¥å…·ï¼ŒFESçš„è®¾è®¡ä¹Ÿä¸ä¾‹å¤–ã€‚

è¯„ä¼°æˆ‘ä»¬ç°æœ‰è®¾è®¡çš„æœ€ä½³æ–¹æ³•æ˜¯ç›´æ¥å¬å–ä½¿ç”¨p5.jsçš„äººä»¬çš„æ„è§ã€‚æˆ‘ä»¬åœ¨2021å¹´è¿›è¡Œäº†ç¤¾åŒºè°ƒæŸ¥ï¼Œä»¥æ”¶é›†å¯¹å‹å¥½é”™è¯¯çš„åé¦ˆå’Œæœªæ¥æœŸæœ›ã€‚

æˆ‘ä»¬ç›¸ä¿¡æ¥è‡ªç¤¾åŒºæˆå‘˜çš„è§è§£å¯¹äºæˆ‘ä»¬çš„è´¡çŒ®è€…å°†æ˜¯æœ‰å¸®åŠ©çš„ã€‚æ‚¨å¯ä»¥é€šè¿‡æ‘˜è¦æ¼«ç”»æˆ–å®Œæ•´æŠ¥å‘Šæ¥æŸ¥çœ‹ç»“æœï¼š
* [21-22 FESè°ƒæŸ¥æŠ¥å‘Šæ¼«ç”»]
* [21-22 FESè°ƒæŸ¥å®Œæ•´æŠ¥å‘Š]

[21-22 FESè°ƒæŸ¥æŠ¥å‘Šæ¼«ç”»]: https://almchung.github.io/p5jsFESsurvey/
[21-22 FESè°ƒæŸ¥å®Œæ•´æŠ¥å‘Š]: https://observablehq.com/@almchung/p5-fes-21-survey

## ç¼–å†™å‹å¥½é”™è¯¯ä¿¡æ¯

å¦‚ä½•é€šè¿‡ç¼–å†™å’Œç¿»è¯‘é”™è¯¯æ¶ˆæ¯æ¥ä¸ºp5.jsåº“åšå‡ºè´¡çŒ®ï¼Ÿ

FESæ˜¯p5.jså›½é™…åŒ–å·¥ä½œçš„ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬é€šè¿‡åŸºäº[i18next]çš„`translator()`å‡½æ•°ç”Ÿæˆæ‰€æœ‰FESæ¶ˆæ¯çš„å†…å®¹ã€‚è¿™ç§åŠ¨æ€é”™è¯¯æ¶ˆæ¯ç”Ÿæˆé€‚ç”¨äºæ‰€æœ‰è¯­è¨€ï¼ŒåŒ…æ‹¬p5.jsçš„é»˜è®¤è¯­è¨€è‹±è¯­ã€‚

æˆ‘ä»¬æ¬¢è¿æ¥è‡ªä¸–ç•Œå„åœ°çš„è´¡çŒ®ï¼ğŸŒ

[i18next]: https://www.i18next.com/
#### ç¼–å†™æœ€ä½³å®è·µ

FESæ¶ˆæ¯ç¼–å†™è€…åº”è¯¥ä¼˜å…ˆè€ƒè™‘é™ä½ç†è§£é”™è¯¯æ¶ˆæ¯çš„éšœç¢ï¼Œå¢åŠ è°ƒè¯•è¿‡ç¨‹çš„å¯è®¿é—®æ€§ã€‚

[Friendly Errors i18n Book]è®¨è®ºäº†åœ¨è·¨æ–‡åŒ–i18nç¯å¢ƒä¸­ç¼–å†™å‹å¥½é”™è¯¯æ¶ˆæ¯çš„æŒ‘æˆ˜å’Œæœ€ä½³å®è·µã€‚ä»¥ä¸‹æ˜¯ä¹¦ä¸­çš„ä¸€äº›è¦ç‚¹ï¼š

* äº†è§£æ‚¨çš„å—ä¼—ï¼šä¸è¦å¯¹æˆ‘ä»¬çš„é”™è¯¯æ¶ˆæ¯çš„å—ä¼—åšå‡ºå‡è®¾ã€‚å°è¯•äº†è§£è°åœ¨ä½¿ç”¨æˆ‘ä»¬çš„åº“ä»¥åŠä»–ä»¬å¦‚ä½•ä½¿ç”¨å®ƒã€‚
* ä¿æŒè¯­è¨€åŒ…å®¹æ€§ã€‚æˆ‘ä»¬åŠªåŠ›ä½¿é”™è¯¯æ¶ˆæ¯â€œå‹å¥½â€ï¼Œè¿™å¯¹æ‚¨æ¥è¯´æ„å‘³ç€ä»€ä¹ˆï¼Ÿåœ¨æ‚¨çš„è¯­è¨€ä¸­å¯»æ‰¾å¯èƒ½çš„

åè§å’Œä¼¤å®³ã€‚éµå®ˆ[p5.jsè¡Œä¸ºå‡†åˆ™]ã€‚
* å°½é‡ä½¿ç”¨ç®€å•çš„å¥å­ã€‚è€ƒè™‘å°†å¥å­åˆ†æˆè¾ƒå°çš„å—ï¼Œä»¥æœ€å¤§ç¨‹åº¦åœ°åˆ©ç”¨i18nextçš„[æ’å€¼]åŠŸèƒ½ã€‚
* ä¼˜å…ˆè€ƒè™‘è·¨æ–‡åŒ–æ²Ÿé€šï¼Œå¹¶åœ¨ä¸åŒè¯­è¨€ä¹‹é—´æä¾›å‡ºè‰²çš„ä½“éªŒã€‚é¿å…ä½¿ç”¨æˆè¯­ã€‚
* é€æ­¥ä»‹ç»ä¸€ä¸ªæŠ€æœ¯æ¦‚å¿µæˆ–æŠ€æœ¯æœ¯è¯­ã€‚ä¿æŒæŠ€æœ¯å†™ä½œçš„ä¸€è‡´æ€§ã€‚å°è¯•é“¾æ¥ä¸€ä¸ªç”¨ç®€æ˜å®ä¾‹ç¼–å†™çš„é¢å‘åˆå­¦è€…çš„å¤–éƒ¨èµ„æºã€‚

[Friendly Errors i18n Book]: https://almchung.github.io/p5-fes-i18n-book/
[æ’å€¼]: https://www.i18next.com/translation-function/interpolation
[p5.jsè¡Œä¸ºå‡†åˆ™]: https://github.com/processing/p5.js/blob/main/CODE_OF_CONDUCT.md#p5js-code-of-conduct
[ä¸“å®¶çš„ç›²ç‚¹]: https://tilt.colostate.edu/TipsAndGuides/Tip/181

[Friendly Errors i18n Book]æ˜¯ä¸€ä¸ªå…¬å…±é¡¹ç›®ï¼Œæ‚¨å¯ä»¥é€šè¿‡è¿™ä¸ªå•ç‹¬çš„[repo]ä¸ºè¯¥ä¹¦åšå‡ºè´¡çŒ®ã€‚

[repo]: https://github.com/almchung/p5-fes-i18n-book
#### ç¿»è¯‘æ–‡ä»¶çš„ä½ç½®

`translator()`åŸºäºi18nextï¼Œä»`src/core/internationalization.js`ä¸­å¯¼å…¥ã€‚å®ƒé€šè¿‡ä»JSONç¿»è¯‘æ–‡ä»¶ä¸­æŸ¥æ‰¾æ–‡æœ¬æ•°æ®æ¥ç”Ÿæˆæ¶ˆæ¯ï¼š
```
translations/{{æ£€æµ‹åˆ°çš„è¯­è¨€ä»£ç ï¼Œé»˜è®¤ä¸ºen}}/translation.json
```

ç¤ºä¾‹ï¼š
å¦‚æœæ£€æµ‹åˆ°çš„æµè§ˆå™¨è¯­è¨€ç¯å¢ƒæ˜¯éŸ©è¯­ï¼ˆè¯­è¨€æ ‡è¯†ç¬¦ï¼š`ko`ï¼‰ï¼Œ`translator()`å°†ä»`translations/ko/translation.json`ä¸­è¯»å–ç¿»è¯‘çš„æ–‡æœ¬å—ã€‚ç„¶åï¼Œ`translator()`å°†å°†æ–‡æœ¬å—ç»„åˆæˆæœ€ç»ˆçš„æ¶ˆæ¯ã€‚

è¯­è¨€æ ‡è¯†ç¬¦è¿˜å¯ä»¥åŒ…æ‹¬åœ°åŒºä¿¡æ¯ï¼Œä¾‹å¦‚`es-PE`ï¼ˆç§˜é²çš„è¥¿ç­ç‰™è¯­ï¼‰ã€‚

#### ç¿»è¯‘æ–‡ä»¶çš„ç»“æ„
`translation.json`å…·æœ‰[i18nextä½¿ç”¨çš„æ ¼å¼](https://www.i18next.com/misc/json-format)ã€‚

ç¿»è¯‘æ–‡ä»¶çš„åŸºæœ¬æ ¼å¼æ˜¯åœ¨èŠ±æ‹¬å·`{}`ä¸­ä½¿ç”¨åŒå¼•å·`""`æ‹¬èµ·æ¥çš„é”®å’Œå€¼ï¼ˆæ¶ˆæ¯ï¼‰ï¼š
```json
{ "key": "value" }
```
ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä»¥æ­¤æ ¼å¼ä¿å­˜çš„ASCIIæ ‡å¿—ï¼š
```json
"logo": "    _ \n /\\| |/\\ \n \\ ` ' /  \n / , . \\  \n \\/|_|\\/ \n\n"
```
i18nextæ”¯æŒæ’å€¼ï¼Œå…è®¸æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªå˜é‡ä»¥åŠ¨æ€ç”Ÿæˆæ¶ˆæ¯ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªèŠ±æ‹¬å·`{{}}`æ¥è®¾ç½®å˜é‡çš„å ä½ç¬¦ï¼š
```json
"greeting": "ä½ å¥½ï¼Œ{{who}}ï¼"
```
è¿™é‡Œï¼Œé”®æ˜¯`greeting`ï¼Œå˜é‡åæ˜¯`who`ã€‚

ä¸ºäº†åŠ¨æ€ç”Ÿæˆè¯¥æ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦ä¼ 

é€’ä¸€ä¸ªå€¼ï¼š
```JavaScript
translator('greeting', { who: 'everyone' } );
```
ç”±`translator`ç”Ÿæˆçš„ç»“æœå°†å¦‚ä¸‹æ‰€ç¤ºï¼š
```
ä½ å¥½ï¼Œeveryoneï¼
```

è¿™æ˜¯`fes`ä¸­çš„ä¸€ä¸ªé¡¹`fileLoadError`ï¼Œæ¼”ç¤ºäº†æ’å€¼ï¼š
```json
"image": "çœ‹èµ·æ¥åŠ è½½å›¾åƒæ—¶å‡ºç°é—®é¢˜ã€‚{{suggestion}}"
```
ä¸ºäº†åŠ¨æ€ç”Ÿæˆæœ€ç»ˆçš„æ¶ˆæ¯ï¼ŒFESå°†ä½¿ç”¨è¯¥é”®å’Œé¢„å…ˆç”Ÿæˆçš„`suggestion`å€¼è°ƒç”¨`translator()`ã€‚
```JavaScript
translator('fes.fileLoadError.image', { suggestion });
```

#### å¦‚ä½•æ·»åŠ æˆ–ä¿®æ”¹ç¿»è¯‘

[å›½é™…åŒ–æ–‡æ¡£]æä¾›äº†é€æ­¥æŒ‡å—ï¼Œä»‹ç»äº†å¦‚ä½•æ·»åŠ å’Œä¿®æ”¹ç¿»è¯‘æ–‡ä»¶ã€‚

[å›½é™…åŒ–æ–‡æ¡£]: https://github.com/processing/p5.js/blob/main/contributor_docs/internationalization.md


## ç†è§£FESçš„å·¥ä½œåŸç†
åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¦‚è¿°FESå¦‚ä½•ç”Ÿæˆå’Œæ˜¾ç¤ºæ¶ˆæ¯ã€‚æœ‰å…³FESå‡½æ•°çš„æ›´è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„[FESå‚è€ƒ+å¼€å‘ç¬”è®°]ã€‚

[FESå‚è€ƒ+å¼€å‘ç¬”è®°]: https://github.com/processing/p5.js/blob/main/contributor_docs/fes_reference_dev_notes.md


#### æ¦‚è§ˆ
p5.jsä»å¤šä¸ªä½ç½®è°ƒç”¨FESï¼Œä»¥å¤„ç†ä¸åŒçš„æƒ…å†µï¼ŒåŒ…æ‹¬ï¼š
* æµè§ˆå™¨å¼•å‘é”™è¯¯ã€‚
* ç”¨æˆ·ä»£ç è°ƒç”¨p5.js APIçš„å‡½æ•°ã€‚
* å…¶ä»–ç”¨æˆ·å¯ä»¥ä»å¸®åŠ©æ¶ˆæ¯ä¸­å—ç›Šçš„è‡ªå®šä¹‰æƒ…å†µã€‚

#### FESä»£ç ä½ç½®
æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®æ‰¾åˆ°FESçš„æ ¸å¿ƒç»„ä»¶ï¼š
`src/core/friendly_errors`ã€‚
æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®æ‰¾åˆ°`translator()`ä½¿ç”¨çš„ç¿»è¯‘æ–‡ä»¶ï¼š
`translations/`ã€‚

#### FESæ¶ˆæ¯ç”Ÿæˆå™¨
è¿™äº›å‡½æ•°ä¸»è¦è´Ÿè´£æ•è·é”™è¯¯å¹¶ç”ŸæˆFESæ¶ˆæ¯ï¼š
* [`_friendlyFileLoadError()`]æ•è·æ–‡ä»¶åŠ è½½é”™è¯¯ã€‚
* [`_validateParameters()`]åŸºäºå†…è”æ–‡æ¡£æ£€æŸ¥p5.jså‡½æ•°çš„è¾“å…¥å‚æ•°ã€‚
* [`_fesErrorMontitor()`]å¤„ç†å…¨å±€é”™è¯¯ã€‚

æœ‰å…³å®Œæ•´å‚è€ƒï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„[å¼€å‘ç¬”è®°]ã€‚

[`_friendlyFileLoadError()`]: https://github.com/processing/p5.js/blob/main/contributor_docs/fes_reference_dev_notes.md#_friendlyfileloaderror
[`_validateParameters()`]: https://github.com/processing/p5.js/blob/main/contributor_docs/fes_reference_dev_notes.md#validateparameters
[`_fesErrorMontitor()`]: https://github.com/processing/p5.js/blob/main/con


FESæ¶ˆæ¯ç”Ÿæˆå™¨
è¿™äº›å‡½æ•°ä¸»è¦è´Ÿè´£æ•è·é”™è¯¯å¹¶ç”ŸæˆFESæ¶ˆæ¯ï¼š
* [`_friendlyFileLoadError()`] æ•è·æ–‡ä»¶åŠ è½½é”™è¯¯ã€‚
* [`_validateParameters()`] æ ¹æ®å†…è”æ–‡æ¡£æ£€æŸ¥p5.jså‡½æ•°çš„è¾“å…¥å‚æ•°ã€‚
* [`_fesErrorMontitor()`] å¤„ç†å…¨å±€é”™è¯¯ã€‚

å¦‚éœ€å®Œæ•´å‚è€ƒï¼Œè¯·æŸ¥é˜…æˆ‘ä»¬çš„[å¼€å‘ç¬”è®°]ã€‚

[`_friendlyFileLoadError()`]: https://github.com/processing/p5.js/blob/main/contributor_docs/fes_reference_dev_notes.md#_friendlyfileloaderror
[`_validateParameters()`]: https://github.com/processing/p5.js/blob/main/contributor_docs/fes_reference_dev_notes.md#validateparameters
[`_fesErrorMontitor()`]: https://github.com/processing/p5.js/blob/main/contributor_docs/fes_reference_dev_notes.md#feserrormonitor
[å¼€å‘ç¬”è®°]: https://github.com/processing/p5.js/blob/main/contributor_docs/fes_reference_dev_notes.md

FESæ¶ˆæ¯æ˜¾ç¤ºå™¨
`fes_core.js/_friendlyError()` åœ¨æ§åˆ¶å°ä¸­æ‰“å°ç”Ÿæˆçš„å‹å¥½é”™è¯¯æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼š

```JavaScript
p5._friendlyError(
  translator('fes.globalErrors.type.notfunc', translationObj)
);
```
è¯¥å‡½æ•°å¯ä»¥åœ¨p5çš„ä»»ä½•åœ°æ–¹è°ƒç”¨ã€‚

å…³é—­FES
å¯èƒ½æœ‰äº›æƒ…å†µä¸‹æ‚¨å¸Œæœ›[ç¦ç”¨FESä»¥æå‡æ€§èƒ½]ã€‚

å½“`p5.disableFriendlyErrors`è®¾ç½®ä¸º`true`æ—¶ï¼Œæ‚¨å¯ä»¥å…³é—­FESã€‚

ç¤ºä¾‹ï¼š
```JavaScript
p5.disableFriendlyErrors = true;

function setup() {
  createCanvas(100, 50);
}
```

p5çš„å•ä¸ªå‹ç¼©æ–‡ä»¶ï¼ˆå³p5.min.jsï¼‰ä¼šè‡ªåŠ¨çœç•¥FESã€‚

[ç¦ç”¨FESä»¥æå‡æ€§èƒ½]: https://github.com/processing/p5.js/wiki/Optimizing-p5.js-Code-for-Performance#disable-the-friendly-error-system-fes
